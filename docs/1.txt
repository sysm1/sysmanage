
-- 工厂信息 关键字 factory
SET NAMES utf8;
CREATE TABLE  factory_info(
	`id` int NOT NULL AUTO_INCREMENT,
	`name` varchar(255) NOT NULL,
	 pinyin varchar(255),
	`mark` text,
	PRIMARY KEY (`id`),
	UNIQUE `uniqe_1` (`code`),
	UNIQUE `uniqe_2` (`name`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


-- 布种信息  关键字 cloth
create table cloth_info (
	id int not null auto_increment,
	pinyin varchar(255), 						-- 
	cloth_name varchar(255) not null unique, -- 布种名称
	order_name varchar(255) not null unique, -- 下单名称
	create_time date not null,
	mark text,
	PRIMARY KEY (`id`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8;

-- 工艺信息  关键字technology
create table technology_info(
	id	int not null auto_increment,
	pinyin varchar(255),
	name varchar(255) not null unique,
	mark text,
	PRIMARY KEY (`id`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8;

-- 业务员信息  关键字salesman
create table salesman_info(
	id	int not null auto_increment,
	name varchar(255) not null unique,
	mark text,
	PRIMARY KEY (`id`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8;

-- 布种单位   关键字unit
create table cloth_unit (  
	id int not null auto_increment,
	cloth_id not null,
	kg  double not null,
	cm  double not null,
	yard double not null,
	item int not null,  
	PRIMARY KEY (`id`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8;

DROP TABLE IF EXISTS `cloth_unit`;
CREATE TABLE `cloth_unit` (
  `id` int(11) NOT NULL auto_increment,
  `cloth_id` int(11) NOT NULL,
  `kg` double NOT NULL,
  `cm` double NOT NULL,
  `yard` double NOT NULL,
  `item` int(11) NOT NULL DEFAULT '1', -- 默认单位 条， 默认值 1
  PRIMARY KEY (`id`),
  UNIQUE KEY `cloth_unit_unique` (`cloth_id`) USING BTREE
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


-- 布种余量 -- kg cm yard item   allowance 余量关键字
DROP TABLE IF EXISTS `cloth_allowance`;
create table cloth_allowance (
	id int not null auto_increment,
	cloth_id int not null,
	factory_id int not null,
	allowance double not null,    -- 现余量
	unit varchar(32) not null, -- 单位（录入单位）
	old_sum double not null,      -- 前余量(单位需要统一)
	change_sum double not null,   -- 变动量(单位需要统一)
	input_date datetime not null,  -- 日期
	mark text,
	create_time datetime not null,  -- 更新时间了
	PRIMARY KEY (`id`),
	UNIQUE KEY `allowance_un` (`cloth_id`,`factory_id`) USING BTREE
)ENGINE=InnoDB DEFAULT CHARSET=utf8;

-- 修改时只能修改新增量。布种与工厂唯一
-- 单位问题

-- 开版录入  关键字  sample
create table sample_input(
	id	int not null auto_increment,
	sample_date date,   -- 开版日期
	factory_id	int not null,
	cloth_id	int not null,
	code_type	int not null, -- 0 文件分色号，1 工厂编号, 2 我司编号
	file_code varchar(255), -- 文件分色号
	factory_code varchar(255),  -- -- 编号如果选择“工厂编号” 在后边会跟随一个加号  可以添加回版编号，最多两个
	my_company_code varchar(255),	-- 我司编号
	technology_id int, -- 工艺id
	saleman_id int not null, -- 业务员
	picture varchar(255) not null, -- 图片(缩略图，原图)
	demand text,  -- 需求
	mark text,  -- 备注
	return_mark text,  -- 回版备注
	status int not null,  -- 0 未回  1 新版 2 新厂 3 新色 4已回
	reply_date datetime,  -- 回版日期
	create_time datetime not null,
	PRIMARY KEY (`id`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8;

 -- 开版录入附加表
create table sample_additional(
	id int not null auto_increment,
	sample_id int,
	factory_code varchar(255),  -- 工厂编号
	factory_color varchar(255) null, -- 工厂color
	PRIMARY KEY (`id`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8;


-- 花号基本资料 关键字  flower
create table flower_info(
	id int not null auto_increment,
	factory_id	int not null,
	my_company_code varchar(255),	-- 我司编号
	cloth_id	int not null,
	file_color varchar(255),
	technology_id int, -- 工艺id
	picture varchar(255) not null, -- 图片(缩略图，原图)
	status int not null default 1, -- 0 删除 1 正常
	PRIMARY KEY (`id`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8;

-- 花号附加表
create table flower_additional(
	id int not null auto_increment,
	flower_id int,
	factory_code varchar(255),       -- 工厂编号
	factory_color varchar(255) null, -- 工厂color
	my_company_code varchar(255),	 -- 我司编号(冗余)
	my_company_color varchar(255),
	PRIMARY KEY (`id`)  
)ENGINE=InnoDB DEFAULT CHARSET=utf8;

-- 下单预录入表  关键字  input
create table order_input(
	id int not null auto_increment,
	cloth_id int,
	my_company_code varchar(255), -- 我司编号(来自花号基本资料表)
	salesman_id int,
	status int default 0,   -- 0 未下单 1 已下单
	create_time datetime,
	PRIMARY KEY (`id`) 
)ENGINE=InnoDB DEFAULT CHARSET=utf8;

create table order_input_additional(
	id int not null auto_increment,
	input_id int,
	my_company_color varchar(255), -- 我司color(来自花号基本资料表)
	num int,				-- 预录入数量
	unit varchar(16),  -- -- kg cm yard item
	mark text,   -- 
	PRIMARY KEY (`id`) 
)ENGINE=InnoDB DEFAULT CHARSET=utf8;

--预下单录入汇总表  关键字  inputsummary
create table order_input_summary(
	id int not null auto_increment,
	cloth_id	int not null,
	my_company_code varchar(255), -- 我司code
	my_company_color varchar(255), -- 我司color
	num int,					  -- 单位为条(从相应的余量表中减去该数)
	mark text,   				-- 如果有“备注”则显示“见明细”，如果所有的“备注”都为空则显示“无”
	order_ids varchar(255),  	-- order_id组合，以,分隔
	PRIMARY KEY (`id`) 
)ENGINE=InnoDB DEFAULT CHARSET=utf8;

-- 下单录入  关键字  ordersummary
create table order_summary(
	id int not null auto_increment,  
	order_code varchar(255), 			-- 以“YXD”开头后面以当天日期加4为数字结尾，例如YXD201501150001为当日的第一张单
	order_date datetime,
	cloth_id int not null,
	factory_id	int not null,
	technology_id int, 				-- 工艺id
	my_company_code varchar(255),  -- 我司编号
	my_company_color varchar(255), -- 我司color
	factory_code varchar(255),     -- 根据编号 从花号基本表里查找(如何选取，从哪里来)
	factory_color varchar(255),    -- 根据编号 从花号基本表里查找(如何选取，从哪里来)
	cloth_num int,  				-- 工厂布种余量
	num int,        				-- 下单数量(单位为条)
	standard varchar(255), 			-- 规格
	packing_style  varchar(255),	 -- 包装方式
    salesmans text,					 -- 多业务员id，备注组合
	mark text,  					-- 备注
	print_status int default 0,  					-- 状态 (0 未打印  1 打印)
	print_num int,						-- 打印次数
	status varchar(255), -- 工厂不一样   ----新厂 我司编号不一样----新花 布种不一样---新布 颜色不一样----新色   红色字体 可以组合  （新厂新花) 一样的为正常   绿色字体  
	return_status int default 0,   -- 0 未回货  1 已回货
	create_time datetime,  -- 下单时间
	PRIMARY KEY (`id`) 
)ENGINE=InnoDB DEFAULT CHARSET=utf8;

-- 回货进度 关键字  process
create table return_goods_process(
	id int not null auto_increment,
	summary_id int,
	return_date datetime,   -- 回货日期
	return_num int,		-- 回货数量
	return_unit  varchar(16), -- -- kg cm yard item
	statistics_num int,      -- 换算单位后数量(条)
	return_color varchar(255),  -- 实到颜色
	mark text,  -- 备注
	create_time datetime,
	PRIMARY KEY (`id`) 
)ENGINE=InnoDB DEFAULT CHARSET=utf8;

-- 下单通知  关键字  notify
create table order_notify_info(
	id int not null auto_increment,
	no varchar(255),   -- 打印编号
	summary_ids varchar(255),  -- 下单录入的id组合
	mark  text,				   -- 备注
	create_time datetime,
	PRIMARY KEY (`id`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8

 -- 关键字  property
create table param_properties(
	id int not null auto_increment,   -- 1 修改、删除权限码 2 修改打印下单勾选条数
	demo varchar(255),
	value varchar(255),
	PRIMARY KEY (`id`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8;

-- 作为序号生产器使用。
create table date_version(
	id int not null auto_increment,
	date_k varchar(255) unique,   -- yyyy-MM-dd 每天标识
	value_v int default 0,				-- 每天递增数
	PRIMARY KEY (`id`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8;



-- 联想查询： 布种，工厂，工艺, 我司编号 我司color,



  
  
